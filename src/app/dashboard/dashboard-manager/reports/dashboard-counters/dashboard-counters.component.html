
<h1>סטטוס מערכת עדכני ({{today}})</h1>

<div class="dashboard-counters">
    <div class="dashboard-counters__item" id="inlays">
        <div class="dashboard-counters__item-svg-container dashboard-counters__item-svg-container--inlays">
            <mat-icon>departure_board</mat-icon>
        </div>
        <div class="dashboard-counters__item-text">
            <h1 class="dashboard-counters__item-count">
                <span [countUp]="inlays.length" [options]="countUpOptionsCounter"></span>
            </h1>
            <p class="dashboard-counters__item-description">סה״כ שיבוצים</p>
        </div>
    </div>

    <div class="dashboard-counters__separator"></div>

    <div class="dashboard-counters__item" id="orders">
        <div class="dashboard-counters__item-svg-container dashboard-counters__item-svg-container--orders">
            <mat-icon>date_range</mat-icon>
        </div>
        <div class="dashboard-counters__item-text">
            <h1 class="dashboard-counters__item-count">
                <span [countUp]="orders.length" [options]="countUpOptionsCounter"></span>
            </h1>
            <p class="dashboard-counters__item-description">סה״כ הזמנות</p>
        </div>
    </div>

    <div class="dashboard-counters__item" id="drivers">
        <div class="dashboard-counters__item-svg-container dashboard-counters__item-svg-container--drivers">
            <mat-icon>local_shipping</mat-icon>
        </div>
        <div class="dashboard-counters__item-text">
            <h1 class="dashboard-counters__item-count">
                <span [countUp]="drivers.length" [options]="countUpOptionsCounter"></span>
            </h1>
            <p class="dashboard-counters__item-description">נהגים</p>
        </div>
    </div>
    
    <div class="dashboard-counters__separator"></div>

    <div class="dashboard-counters__item" id="routes">
        <div class="dashboard-counters__item-svg-container dashboard-counters__item-svg-container--routes">
            <mat-icon>map</mat-icon>
        </div>
        <div class="dashboard-counters__item-text">
            <h1 class="dashboard-counters__item-count">
                <span [countUp]="routes.length" [options]="countUpOptionsCounter"></span>
            </h1>
            <p class="dashboard-counters__item-description">מסלולים</p>
        </div>
    </div>
</div>

<div class="dashboard-by-location__canvas">

    <canvas baseChart class="dashboard-by-location__canvas" [data]="doughnutChartData" [labels]="doughnutChartLabels"
        [chartType]="doughnutChartType" [plugins]="doughnutChartPlugins" [options]="doughnutChartOptions"
        [colors]="doughnutChartColors">
    </canvas>

</div>


<h3>שיבוצים</h3>

<div class="table-container">
    <table id="excel-table" mat-table [dataSource]="inlaysTable" matSort matSortActive="name" matSortDisableClear matSortDirection="asc">

        <ng-container matColumnDef="uid">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="uid">מזהה שיבוץ</th>
            <td mat-cell *matCellDef="let row">{{row?.uid}}</td>
        </ng-container>

        <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="date">תאריך האספקה שנקבע</th>
            <td mat-cell *matCellDef="let row">{{getDay(row?.date)}} {{row?.date | dateFormat}}</td>
        </ng-container>

        <ng-container matColumnDef="driver">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="driver">נהג</th>
            <td mat-cell *matCellDef="let row">
                <span class="link" (click)="showDriver(row.driver)">{{row.driver.displayName}}</span>
            </td>
        </ng-container>

        <ng-container matColumnDef="route">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="route">מסלול</th>
            <td mat-cell *matCellDef="let row">
                <span class="link" (click)="showRoute(row.route)">{{row.route.name}}</span>
            </td>
        </ng-container>

        <ng-container matColumnDef="routeDetails">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="routeDetails">תיאור המסלול</th>
            <td mat-cell *matCellDef="let row">
                <p class="route-details-draw">{{getRouteDraw(row.orders)}}, </p>
                <span class="route-details-length">אורך המסלול: {{getRouteDistance(row.orders)}}, </span>
                <span class="route-details-length">מספר נקודות פריקה: {{row.orders.length}}, </span>
                <span class="route-details-length">משקל כולל: {{getRouteTotalWeight(row.orders)}} טון, </span>
                <span class="route-details-length">זמן משוער: {{getRouteTotalTime(row.orders)}} </span> 
            </td>
        </ng-container>

        <ng-container matColumnDef="orders">
            <th mat-header-cell *matHeaderCellDef mat-sort-header="orders">רשימת הזמנות</th>
            <td mat-cell *matCellDef="let row">
                <ul>
                    <li *ngFor="let order of row.orders">
                        <span class="link" (click)="showOrder(order)">{{order.deliveryCity}}, {{order.deliveryAddress}}
                            {{order.deliveryAddressNumber}}</span>, 
                    </li>
                </ul>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="inlaysColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: inlaysColumns;"></tr>
    </table>

    <button class="export" type="submit" (click)="export()" mat-raised-button color="primary">ייצא דו״ח מערכת</button>
</div>

